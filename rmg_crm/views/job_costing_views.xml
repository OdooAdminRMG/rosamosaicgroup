<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="job_costing_tree" model="ir.ui.view">
            <field name="name">job.costing</field>
            <field name="model">job.costing.report</field>
            <field name="arch" type="xml">
                <tree create="0" editable="bottom" delete="0">
                    <field name="compute_all_fields" invisible="1"/>
                    <field name="filter_id" invisible="0"/>
                    <field name="sale_id" readonly="1"/>
                    <field name="job_name"/>
                    <field name="so_create_date" invisible="0"/>
                    <field name="contract_amount" sum="Total Contract Amount" readonly="1"/>
                    <field name="billings_to_date" sum="Total Billings To Date" readonly="1"/>
                    <field name="remaining" sum="Total Remaining" readonly="1"/>
                    <field name="total_cost_of_purchase" sum="Total Cost Of Purchase" optional="show" readonly="1"/>
                    <field name="total_cost_of_components" sum="Total Cost Of Components" optional="show" readonly="1"/>
                    <field name="total_cost_of_purchase_timesheet" sum="Total " optional="show" readonly="1"/>
                    <field name="actual" sum="Total Actual Cost" readonly="1"/>
                    <field name="budget" sum="Total Budget Cost" readonly="1"/>
                    <field name="pct" widget="percentage" readonly="1"/>
                    <field name="overrun" sum="Total Overrun" readonly="1"/>
                </tree>
            </field>
        </record>
        <record id="act_job_costing" model="ir.actions.act_window">
            <field name="name">Job Costing</field>
            <field name="res_model">job.costing.report</field>
            <field name="view_mode">tree</field>
        </record>
        <menuitem id="job_costing_menu"
                  name="Job Costing"
                  parent="sale.sale_menu_root"
                  sequence="20"/>
        <menuitem id="report_job_costing"
                  name="Job Costing"
                  parent="job_costing_menu"
                  action="rmg_crm.act_job_costing"
                  sequence="1"/>
        <record id="job_costing_search_view" model="ir.ui.view">
            <field name="name">job.costing.view.search</field>
            <field name="model">job.costing.report</field>
            <field name="arch" type="xml">
                <search>
                    <field name="job_name"/>
                    <field name="sale_id"/>
                    <separator/>
                    <filter string="Today" name="today"
                            domain="[('so_create_date', '&lt;=', datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S'))]"/>
                    <separator/>
                    <filter string="End of Last Month" name="end_of_last_month"
                            domain="[
                                ('so_create_date', '&lt;=',
                                    (
                                        datetime.date.today().replace(
                    day=1
                ) - datetime.timedelta(days=1)
                                    ).strftime('%Y-%m-%d')
                                )
                            ]"/>
                    <separator/>
                    <filter name="end_of_last_quarter" string="End of Last Quarter"
                            domain="[('so_create_date','&lt;',time.strftime('%%Y-01-01')
                            if context_today().month &lt; 4 else (time.strftime('%%Y-03-31')
                            if context_today().month &lt; 7 else (time.strftime('%%Y-06-30')
                            if context_today().month &lt; 10 else time.strftime('%%Y-09-30'))))]"/>
                    <separator/>
                    <filter name="end_of_last_financial_year" string="End of Last Financial Year"
                            domain="[('so_create_date','&lt;=',datetime.date.today().replace(month=3, day=31).strftime('%%Y-%%m-%%d'))]"/>
                    <separator/>
                </search>
            </field>
        </record>
    </data>
</odoo>
